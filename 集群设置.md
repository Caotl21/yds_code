初始化集群
sudo kubeadm init --config=kubeadm-config.yaml

时间设置
sudo date -s "2025-08-01 22:42:30"


```bash
kubectl label nodes <node-name> <label-key>=<label-value>
kubectl label nodes k8s-node-rp5-1 computing_device=compute_node1
kubectl label nodes k8s-node-rpi5-2 computing_device=compute_node2
kubectl label nodes phytium-desktop computing_device=compute_node3
kubectl label nodes ec3 computing_device=compute_node4
kubectl label nodes rpi4-1 sensing_device=sensing_node
```

部署calico
```
kubectl apply -f calico-v3.38.1-my.yaml
```

安装
registry.aliyuncs.com/google_containers/coredns:v1.11.3

节点上都需要的镜像
crpi-v0s88r5y9kedn2bv.cn-shanghai.personal.cr.aliyuncs.com/zsns1/calico-kube-controllers:v3.28.1
m.daocloud.io/docker.io/prom/prometheus
m.daocloud.io/docker.io/prom/node-exporter
m.daocloud.io/registry.k8s.io/metrics-server/metrics-server:v0.7.2
crpi-v0s88r5y9kedn2bv.cn-shanghai.personal.cr.aliyuncs.com/zsns1/calico-node:v3.28.1
crpi-v0s88r5y9kedn2bv.cn-shanghai.personal.cr.aliyuncs.com/zsns1/calico-cni:v3.28.1

树莓派上需要的镜像
crpi-v0s88r5y9kedn2bv.cn-shanghai.personal.cr.aliyuncs.com/zsns1/yds:processor_server_7
crpi-v0s88r5y9kedn2bv.cn-shanghai.personal.cr.aliyuncs.com/zsns1/yds:camera_client_ffmpeg_arm_0729

<!-- phytium -->
crpi-v0s88r5y9kedn2bv.cn-shanghai.personal.cr.aliyuncs.com/zsns1/yds:control_belt1_v4

<!-- yds -->
crpi-v0s88r5y9kedn2bv.cn-shanghai.personal.cr.aliyuncs.com/zsns1/yds:control_belt2_v3

部署任务
```
kubectl apply -f img1.yaml


攻击

1. 增加CPU负载: 迁出， 迁入
stress-ng --cpu 4 --cpu-load 80 --timeout 2m

2. 在节点上运行
sudo crictl ps -a | grep <容器名>

sudo crictl inspect <container_id> | grep -i pid

sudo kill -9 pid

3. 插拔网卡

---
导出镜像
sudo ctr -n k8s.io images export redis-image.tar m.daocloud.io/docker.io/library/redis:latest
sudo nerdctl --namespace k8s.io save -o redis-image.tar redis:7.2

导入镜像
sudo ctr -n k8s.io images import redis-image.tar
sudo nerdctl --namespace k8s.io load -i /tmp/redis-image.tar


恶意攻击的命名空间
kubectl get pods -n security-playground
kubectl exec -it attack-simulator -n security-playground -- /bin/sh
